{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SpellDefinition",
  "type": "object",
  "required": ["id", "display_name_key", "card_type", "target_type", "effects"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for this spell"
    },
    "display_name_key": {
      "type": "string"
    },
    "description_key": {
      "type": "string"
    },
    "rarity": {
      "type": "string",
      "enum": ["common", "rare", "epic", "legendary"],
      "default": "common"
    },
    "card_type": {
      "type": "string",
      "const": "spell"
    },
    "hero_id": {
      "type": "string",
      "default": "",
      "description": "Empty string for neutral cards"
    },
    "target_type": {
      "type": "string",
      "enum": ["none", "tile", "stall", "guest"],
      "description": "What the player must target to cast this spell"
    },
    "target_filter": {
      "type": "object",
      "description": "Upfront validation for valid targets. Keys depend on target_type: stall (need_type, operation_model, has_tag), guest (has_status, has_tag, is_core_guest), tile (has_stall, has_guest)"
    },
    "effects": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["type"],
        "properties": {
          "type": {
            "type": "string",
            "description": "Effect type (grant_tokens, fulfill_need, apply_status, etc.)"
          },
          "target": {
            "type": "string",
            "description": "Target selector (stall, guest, target, adjacent_guests, player). Note: 'self' is not available for spell effects."
          }
        }
      }
    },
    "tags": {
      "type": "array",
      "items": { "type": "string" }
    }
  }
}
